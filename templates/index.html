<!DOCTYPE html>
<html lang="en" class="bg-gray-900 text-white">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RaviBot ðŸ’¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="h-screen flex flex-col font-sans">

    <!-- Header -->
    <div class="p-4 bg-gray-800 flex justify-between items-center shadow-md">
        <h1 class="text-2xl font-bold text-lime-400">ðŸ§  RaviBot - History Chat</h1>
        <button onclick="clearChat()"
            class="text-sm border border-gray-500 px-3 py-1 rounded hover:text-white text-gray-300">
            ðŸ—‘ Clear Chat
        </button>
    </div>

    <!-- Chat window -->
    <div id="chat" class="flex-1 overflow-y-auto p-4 space-y-4"></div>

    <!-- Message input form -->
    <form method="POST" class="p-4 bg-gray-800 flex gap-2">
        <input name="query" id="query" autocomplete="off" placeholder="Ask RaviBot a question..."
            class="flex-1 p-2 rounded bg-gray-700 text-white placeholder-gray-400 outline-none" />
        <button type="submit" class="bg-lime-600 hover:bg-lime-500 px-4 py-2 rounded text-white">
            Send
        </button>
    </form>

    <!-- Script: chat memory & restore -->
    <script>
        const chatContainer = document.getElementById("chat");
        const form = document.querySelector("form");
        const queryInput = document.getElementById("query");

        // Load saved messages
        const messages = JSON.parse(localStorage.getItem("ravibot-chat") || "[]");

        function renderMessages() {
            chatContainer.innerHTML = "";
            messages.forEach(msg => {
                const div = document.createElement("div");
                div.className = `max-w-[70%] p-3 rounded-lg whitespace-pre-wrap ${msg.sender === "user" ? "bg-lime-700 ml-auto" : "bg-gray-800"
                    }`;
                div.innerHTML = `<p>${msg.text}</p>`;
                if (msg.pages) {
                    div.innerHTML += `<p class="text-sm text-lime-300 mt-2">ðŸ“„ Pages: ${msg.pages.join(", ")}</p>`;
                }
                chatContainer.appendChild(div);
            });
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        renderMessages();

        form.addEventListener("submit", () => {
            const userInput = queryInput.value.trim();
            if (!userInput) return;

            // Save user question
            messages.push({ sender: "user", text: userInput });
            localStorage.setItem("ravibot-chat", JSON.stringify(messages));
        });

        function clearChat() {
            localStorage.removeItem("ravibot-chat");
            location.reload();
        }
    </script>

</body>

</html>